{% extends "layout.html" %}
{% block content %}

<div class="form-container container">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">
          {{ message }}
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}
  <h1 class="account-text">Manage Your Account Here</h1>
</div>

<div class='form-container container'>
    
    <div class="content-section">
      <div class="media">
        <img class="rounded-circle account-img" src="{{ icon }}">
        <div class="media-body">
          <h2 class="account-heading">{{ current_user.username }}</h2>
          <p class="text-secondary">{{ current_user.email }}</p>
        </div>
        <form style="padding-top: 10px;" action="{{ url_for('users.deleteRequest') }}">
          <button class="btn btn-outline-danger" type="submit">Delete Account</button>
       </form>
      </div>

      <form method="POST" action="" enctype="multipart/form-data">
          <!-- protect our form from certain attacks -->
          {{ update_form.hidden_tag() }}
          <legend class="border-bottom mb-4">Update your Account</legend>
          
          <div class="form-group">
            {{ update_form.username.label(class="form-control-label") }}
            {% if update_form.username.errors %}
        {{ update_form.username(class="form-control form-control-lg is-invalid my-customised") }}
              <div class="alert alert-danger" role="alert">
                  {% for error in update_form.username.errors %}
                    <span>{{ error }}</span>
                  {% endfor %}
              </div>
            {% else %}
        {{ update_form.username(class="form-control form-control-lg my-customised") }}
            {% endif %}
          </div>
          
          <div class="form-group">
            {{ update_form.email.label(class="form-control-label") }}
            {% if update_form.email.errors %}
             {{ update_form.email(class="form-control form-control-lg is-invalid my-customised") }}
              <div class="alert alert-danger" role="alert">
                  {% for error in update_form.email.errors %}
                    <span>{{ error }}</span>
                  {% endfor %}
              </div>
            {% else %}
        {{ update_form.email(class="form-control form-control-lg my-customised") }}
            {% endif %}
          </div>

          <div class="form-group">
            {{ update_form.icon.label() }}
            {{ update_form.icon(class="form-control-file") }}
              {% if update_form.icon.errors %}
                  {% for error in update_form.icon.errors %}
                    <span class="text-danger">{{ error }}</span>
                  {% endfor %}
              {% endif %}
          </div>
          
          <div class="form-group">
              {{ update_form.submit(class="btn btn-outline-info") }}
          </div>
      </form>
    </div>
</div>
{% endblock content %}